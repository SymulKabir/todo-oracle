<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Todo App</title>
  <link rel="stylesheet" href="/static/styles.css" />
</head>
<body>

  <div class="app">
    <h1>üìù Todo App</h1>

    <div class="input-group">
      <input id="title" type="text" placeholder="Todo title" />
      <input id="description" type="text" placeholder="Description" />
      <button onclick="addTodo()">Add</button>
    </div>

    <ul id="list"></ul>
  </div>

  <script>
    async function load() {
      const res = await fetch("/api/todo")
      const json = await res.json()
      const todos = json.data || []

      document.getElementById("list").innerHTML =
        todos.map(t => `
          <li class="todo-item">
            <div class="todo-main">
              <h3>${t.title}</h3>
              <p>${t.description}</p>
            </div>

            <div class="todo-meta">
              <span class="status ${t.status.toLowerCase()}">
                ${t.status}
              </span>
              <small>üìÖ ${t.due_date}</small>
            </div>
          </li>
        `).join("")
    }

    async function addTodo() {
      const title = document.getElementById("title").value
      const description = document.getElementById("description").value

      if (!title || !description) {
        return alert("Title and description required")
      }

      await fetch("/api/todo", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          title,
          description,
          status: "Pending"
        })
      })

      document.getElementById("title").value = ""
      document.getElementById("description").value = ""
      load()
    }

    load()
  </script>

</body>
</html>
